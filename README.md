# 微服务架构初探
&nbsp;&nbsp;&nbsp;&nbsp;本项目作为我进入微服务架构的第一个尝试性的项目，我将从数据存储，服务注册与管理，服务认证再到第三方应用这几个方面第微服务架构进行梳理和研究。实际上虽然对于微服务架构略有了解但是了解还不够深刻，对于其优缺点了解的也不多，之所以想使用微服务架构主要目的是为了在工作中提高开发的可复用性，避免过多的重复开发工作，另外使用微服务架构也便于进行扩展，另外也想通过对微服务架构的研究探索协作开发的模式和方法。

## 采用的技术与框架：
* Python 3.X 使用Python一方面是因为自己对Python相对来说比较熟悉，另一方面是因为想要在应用中集成深度学习框架；
* 基于Python的轻量级服务器框架：Flask以及Flask所包含的一系列库；
* NoSQL数据存储：采用的是MongoDB进行数据存储，至于为什么选择MongoDB主要因为它比较火没有别的原因；
* 内存数据库：实际上这一层可有可无，但是如果做服务注册于服务发现一般都需要，采用Redis，因为我比较熟悉；
* Consul，做服务注册和服务发现的框架类似于zookeeper,为什么选用consul而不是zookeeper，我也不知道，就是一时兴起；
* Nginx负载，实际上不确定是否需要做反向代理或者负载均衡，不过Nginx使用起来确实方便；
* Docker相关组件，Docker这个东西主要是方便环境的部署，否则这么多组件在一台机器上不进行隔离总是很难去管理，主要是可以通过dockfile直接构建统一的环境，相对来书比较方便；

## 1. 数据存储
&nbsp;&nbsp;&nbsp;&nbsp;从准备开启这个项目的时候就打算做一个数据存储的服务，因为数据存储是极其迫切而且广泛而且迫切的需求，几乎对于任何应用都会有这个需求，因此首先我想到了将数据存储拆分为一个微服务；数据存储微服务系统架构为：  
<center>
<image src="https://blogimage-1251632003.cos.ap-guangzhou.myqcloud.com/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84%E5%9B%BE.JPG"/>
</center>

### 1.1 数据存储
&nbsp;&nbsp;&nbsp;&nbsp;最初设计是完全通过MongoDB对所有文件进行存储，由于考虑到并不是所有用户都考虑安装MongDB，另外如果有用户有需求能够在服务器上看到原始数据，在这样的情况下使用MongoDB进行数据存储是不合适的。所以最终决定同时支持文件存储与数据库存储，对于文件存储不考虑分布式，仅仅支持集中式存储。对于数据库存储则有两种情况：如果文件大小比较小，则直接以二进制方式读取文件在数据库中存储二进制文件；如果文件大小比较大，则通过GridFS对文件进行分片存储。

### 1.2 文件操作
&nbsp;&nbsp;&nbsp;&nbsp;为了使得文件存储服务更加具有通用性，对于文件存储需要定义常见的操作，在文件服务中定义的操作包括：1）文件上传；2）文件下载；3）文件删除；4）文件查看，以文件夹列表形式查看；5）文件移动；以上5个操作中前三个是基本操作，相对比较简单，后两个操作属于扩展操作相对比较麻烦。

### 1.3 文件服务器RESTful接口约定
&nbsp;&nbsp;&nbsp;&nbsp;为了对接口进行统一，对于文件服务我们采用动词+名词的形式编写接口，接口API形式为：
http://XXXX/XXX/XXX/动词短语/目标数据或文件名